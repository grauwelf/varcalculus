\documentclass[12pt,a4paper]{article}
\usepackage[warn] {mathtext}
\usepackage[cp1251]{inputenc}
\usepackage[english, russian]{babel}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{pgfplots}
\usepackage[top=2cm, bottom=2cm, marginparwidth=0pt, left=3cm, right=1.5cm]{geometry}

\begin{document}

\newtheorem*{Def}{Определение}
\newtheorem*{Th}{Теорема}
\newtheorem*{Lem}{Лемма}
\newtheorem*{Note}{Замечание}

\section{Метод Ритца}	
	Выделяют два основных типа методов решения вариационных задач.
	К первому типу относятся методы, сводящие исходную задачу к решению
	дифференциальных уравнений. Эти методы очень хорошо развиты и им будет
	посвящено основное время на лекциях. Альтернативой являются так называемые
	прямые методы. Эти методы тем или иным способом решают исходную задачу по
	поиску функции в заданном классе, которая доставляла бы экстремальное 
	значение заданному функционалу. Один из самых популярных методов этого класса ---
	метод Ритца (также называемый методом Рэлея-Ритца).

	В основе метода Ритца лежит построение минимизирующей последовательности функций.
	Пусть, например, необходимо найти минимум функционала $V[y]$ в классе функций $M$.
	Чтобы задача имела смысл, потребуем, чтобы существовал конечный инфимум $\mu$ значений
	функционала и в классе допустимых функций существовали функции, на которых
	функционал принимает конечные значения. Тогда по определению инфимума существует
	минимизирующая последовательность функций $y_1, y_2, \dots, y_n, \dots$ такая, что
	\[
		\lim_{n \to \infty}V[y_n] = \mu~.
	\]
	Если существует предел $y^*$ этой последовательности, она и будет решением исходной задачи,
	так как будет законен предельный переход
	\[
		V[y^*] = \lim_{n \to \infty}V[y_n]~.
	\]

	Каким же образом стоится эта минимизирующая последовательность в методе Ритца?
	Сначала изложим общую идею, а потом рассмотрим ее конкретную реализацию для одного
	типа вариационных задач. Итак, сначала необходимо выбрать некоторую систему функций,
	которую мы назовем базисной:
	\[
		\varphi_1, \varphi_2, \dots, \varphi_n, \dots~.
	\]
	К функциям $\varphi_n$ выдвигаются два требования. Во-первых, сами эти функции
	принадлежат классу $M$, а во-вторых --- любая конечная линейная комбинация этих функций
	вида
	\[
		y_n = c_1\varphi_1 + c_2\varphi_2 + \dots + c_n\varphi_n
	\]
	принадлежит тому же классу $M$. Исходная задача заменяется следующей: минимизировать
	функцию многих переменных
	\[
		\max_{c_1, \dots, c_n}V[c_1\varphi_1 + \dots + c_2\varphi_n]
	\]
	Решая эту задачу известными (из курса <<Методов оптимизации>>, например) методами,
	получаем некоторое минимальное значение $\mu_n$. Поскольку при увеличении числа слагаемых
	мы только расширяем множество функций, на котором ищется минимум, будет справедлива
	цепочка неравенств $\mu_1 \geq \mu_2 \geq \dots \mu_n \geq \mu_{n+1} \geq \dots$.
	Можно доказать, что при некоторых условиях эта последовательность значений сходится к 
	$\mu$.
	
	\begin{Th}
		Если функционал $V[y]$ непрерывен (в смысле метрики пространства, в котором он
		рассматривается) и система функций ${\varphi_n}$ полная, то 
		\[
			\lim_{n \to \infty} \mu_n = \mu~,
		\]
		где $\mu$ --- минимум функционала $V[y]$.
	\end{Th}

	\begin{Note} Быстрота сходимости метода Ритца сильно зависит от выбора
		системы базисных функций. Однако при удачном выборе для
		достижения приемлемой точности часто бывает достаточно 3-4
		слагаемых в линейной комбинации.
	\end{Note}

	Применим изложенную идею к достаточно часто встречающейся вариационной задаче.
	Итак, пусть необходимо минимизировать значение функционала
	\[
		V[y] = \int\limits_0^1{\left[p(x)\left(y'(x)\right)^2 + q(x)y^2(x) - 2f(x)y(x)\right]}dx
	\]
	на множестве функций $M = \left\{y(x)\,\, |\,\, y(x) \in C^2_{[0,1]},\,\, y(0)=y(1)=0 \right\}$.
	Зафиксируем теперь некоторую конечную систему линейно-независимых
	функций $\left\{\varphi_i\right\}_{i=1}^n$ из того же класса $M$.
	Вместо исходной задачи будем решать значительно более узкую задачу
	минимизации функционала на множестве линейных комбинаций
	$$\varphi(x) = \sum_{i=1}^nc_i\varphi_i(x)~.$$
	Подставим эту линейную комбинацию в функционал:
	\begin{align*}
		V[\varphi(x)]& = V\left[\sum_{i=1}^n{c_i\varphi_i(x)}\right] = \\
			     & = \int\limits_0^1 \left\{
			     p(x)\left[\sum_{i=1}^n{c_i\varphi'_i(x)}\right]^2 +
			     q(x)\left[\sum_{i=1}^n{c_i\varphi_i(x)}\right]^2 -
			     2f(x)\sum_{i=1}^n{c_i\varphi_i(x)}
			     \right\}dx~.
	\end{align*}
	Чтобы найти минимум функционала, воспользуемся необходимым условием
	экстремума:
	\[	
		\frac{\partial V}{\partial c_j} = 0, \quad j = \overline{1,n}
	\]
	Дифференцирование функционала по $c_j$ дает
	\[
		\frac{\partial V}{\partial c_j} = 
		     \int\limits_0^1\left\{
			     2p(x)\sum_{i=1}^n{c_i\varphi'_i(x)\varphi'_j(x)} +
			     2q(x)\sum_{i=1}^n{c_i\varphi_i(x)\varphi_j(x)} -
			     2f(x)\varphi_j(x)
		     \right\}dx~.
	\]
	После очевидных преобразований получаем систему линейных алгебраических
	уравнений для нахождения коэффициентов линейной комбинации:
	\[
		\sum_{i=1}^n\left[
			\int\limits_0^1\left(p(x)\varphi'_i(x)\varphi'_j(x) + 
			q(x)\varphi_i(x)\varphi_j(x)\right)dx
		\right]c_i 
		- \int\limits_0^1{f(x)\varphi_j(x)}dx = 0, \quad j =
		\overline{1,n}
	\]
	В матричной форме эта система запишется в виде $Ac=b$, где
	\begin{gather*}
		a_{ij} = \int\limits_0^1\left(p(x)\varphi'_i(x)\varphi'_j(x) + 
			q(x)\varphi_i(x)\varphi_j(x)\right)dx,	\\
		b_j = \int\limits_0^1{f(x)\varphi_j(x)}dx
	\end{gather*}

	Рассмотрим теперь вопрос выбора базисных функций. Простейшим вариантом
	является система кусочно-линейных функций. Чтобы ее построить,
	необходимо вначале задать разбиение отрезка $[0, 1]$ на $n$ отрезков:
	\[
		0 = x_0 < x_1 < \dots < x_n < x_{n+1} = 1~.
	\]
	Полагая $h_i = x_{i+1} - x_i$, определим следующие функции:
	\[
		\varphi_i(x) = 
		\begin{cases}
			0, & \text{если} \quad 0 \leq x \leq x_{i-1}, \\
			\frac{1}{h_{i-1}}\left(x-x_{i-1}\right), & \text{если} \quad x_{i-1} < x \leq x_{i}, \\
			\frac{1}{h_i}\left(x_{i+1}-x\right), & \text{если} \quad x_i < x \leq x_{i+1}, \\
			0, & \text{если} \quad x_{i+1} < x < 1~.
		\end{cases},\quad i = \overline{1,n}
	\]
	\begin{center}
	\begin{tikzpicture}
		\pgfplotsset{every axis plot/.append style={line width=1pt}}
		\begin{axis}[
			xlabel=x,
			ylabel=y,
			xtick=\empty,
			ytick={0,1},
			xtick={0,1},
			extra x ticks={0.333, 0.5},
			extra x tick labels={$x_1$, $x_2$},
			axis x line=middle,
			axis y line=middle]
			\addplot[] coordinates {
			(0.0, 	0.0)
			(0.333, 1.0)
			(0.5,	0.0)
			(1.0,	0.0)
			};
		\draw (4cm,4cm) node {$y=\varphi_1(x)$};
		\end{axis}
	\end{tikzpicture}
	\begin{tikzpicture}
		\pgfplotsset{every axis plot/.append style={line width=1pt}}
		\begin{axis}[
			xlabel=x,
			ylabel=y,
			xtick=\empty,
			ytick={0,1},
			xtick={0,1},
			extra x ticks={0.2, 0.4, 0.75},
			extra x tick labels={$x_{i-1}$, $x_i$, $x_{i+1}$},
			axis x line=middle,
			axis y line=middle]
			\addplot[] coordinates {
			(0.0, 	0.0)
			(0.2,	0.0)
			(0.4,	1.0)
			(0.75,	0.0)
			(1.0,	0.0)
			};
		\draw (5.5cm,4cm) node {$y=\varphi_i(x)$};
		\end{axis}
	\end{tikzpicture}

	\begin{tikzpicture}
		\pgfplotsset{every axis plot/.append style={line width=1pt}}
		\begin{axis}[
			xlabel=x,
			ylabel=y,
			xtick=\empty,
			ytick={0,1},
			xtick={0,1},
			extra x ticks={0.2, 0.4, 0.75},
			extra x tick labels={$x_{i-1}$, $x_i$, $x_{i+1}$},
			axis x line=middle,
			axis y line=middle]
			\addplot[] coordinates {
			(0.0, 	0.0)
			(0.2,	0.0)
			(0.4,	1.0)
			(0.75,	0.0)
			(1.0,	0.0)
			};
		\draw (5.5cm,4cm) node {$y=\varphi_i(x)$};
		\end{axis}
	\end{tikzpicture}

	\end{center}






\end{document}
















