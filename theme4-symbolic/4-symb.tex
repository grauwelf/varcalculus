\documentclass[12pt,a4paper]{article}
\usepackage[warn] {mathtext}
\usepackage[cp1251]{inputenc}
\usepackage[english, russian]{babel}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{pgfplots}
\usepackage{wrapfig}
\usepackage[top=2cm, bottom=2cm, marginparwidth=0pt, left=3cm, right=1.5cm]{geometry}
\usepackage{listings}

\renewcommand\qedsymbol{$\blacksquare$}
\renewcommand{\labelenumi}{\arabic{enumi}) }

\begin{document}

\lstset{language=Matlab, columns=flexible, basicstyle=\ttfamily}
\newtheorem*{Def}{Определение}
\newtheorem*{Th}{Теорема}
\newtheorem*{Lem}{Лемма}
\newtheorem*{Note}{Замечание}
\newtheorem*{Ex}{Пример}

\newenvironment{Sol}{\textbf{Решение.\linebreak}}

\setcounter{section}{3}
\section{Символьные вычисления в среде MATLAB}
	В последней лабораторной работе мы рассмотрим использование возможностей
	символьных вычислений математического пакета MATLAB для решения задач
	вариационного исчисления. Ниже излагаются основные сведения о работе с
	символьными выражениями. Более детальную и полную информацию можно получить,
	воспользовавшись встроенной справочной системой MATLAB. Для этого достаточно
	выполнить команды {\it help symbolic} или {\it doc symbolic}.

\subsection{Символьные выражения}
	\subsubsection{Объявление символьных переменных и констант}
		В процессе символьных вычислений используются переменные и константы
		особого типа, так называемые символьные объекты. Хотя обычно в коде
		MATLAB тип переменных определяется динамически и нет нужды объявлять
		его явно, для символьных объектов дело обстоит иначе. Для объявления
		символьных переменных служит команда {\it syms}, которая в качестве
		аргументов принимает имена переменных, перечисленные через пробел.
		Например, так:
\begin{lstlisting}
>> syms x y
>> syms a b real % объявляемые объекты обозначают вещественные переменные
\end{lstlisting}
		Объявление символьных констант осуществляется при помощи функции {\it sym}.
		Она может принимать в качестве аргумента строку, содержащую специальные переменные,
		численное выражение или вызов функции, как в примерах ниже:
\begin{lstlisting}
>> sym_pi = sym('pi')
>> sym_delta = sym('1/10')
>> sym_sqroot2 = sym('sqrt(2)')
\end{lstlisting}
		Использование символьных констант полезно тем, что вычисления с ними производятся
		точно (т.е. без вычислительных погрешностей) до тех пор, пока не потребуется
		вычислить некоторое числовое значение. Заметим, что при выводе содержимого
		рабочего пространства командой {\it whos} символьные переменные и константы
		отображаются как представители класса {\it sym object}.

\subsubsection{Символьные выражения и манипуляции над ними}
		После объявления, с символьными переменными можно обращаться примерно
		так же, как и с обычными числовыми. В частности, для них определены
		операторы {\bf + - * / \^{}}, с помощью которых можно составлять 
		символьные выражения:
\begin{lstlisting}
>> syms s t A
>> f = s^2 + 4*s + 5
f = 
s^2 + 4*s + 5
>> g = s + 2
g = 
s + 2
>> h = f*g
h = 
(s^2 + 4*s + 5)*(s + 2)
>> z = exp(-s*t)
z = 
exp(-s*t)
>> y = A*exp(-s*t)
y = 
A*exp(-s*t)
\end{lstlisting}
		В приведенных командах символьные переменные s, t, A используются для
		составления символьных выражений, создавая новые символьные переменные 
		f, g, h, z, y. При этом последние автоматически объявляются символьными
		и их значение не вычисляется и никак не преобразуется.

		При манипуляциях с символьными объектами часто бывает полезно узнать,
		какие {\it независимые} переменные содержатся в выражении, заданном строкой S.
		Для этой цели можно использовать функцию {\it findsym}. Например, 
		продолжая пример выше, можно выполнить команду
\begin{lstlisting}
>> findsym(z)
ans = 
A, s, t
\end{lstlisting}
		Заметим, что MATLAB всегда остается прежде всего матричным процессором и 
		потому к символьным переменным можно свободно применять матричную и векторную
		запись и соответствующие встроенные операторы и функции. Приведем пример:
\begin{lstlisting}
>> n = 3;
>> syms x;
>> B = x.^((0:n)'*(0:n))
B =
[   1,   1,   1,   1]
[   1,   x, x^2, x^3]
[   1, x^2, x^4, x^6]
[   1, x^3, x^6, x^9]
\end{lstlisting}

		Продемонстрируем некоторые простые алгебраические манипуляции, которые можно
		осуществлять над символьными объектами. \\\\
		\begin{tabular}{ll}
			\lstinline!expand(S)! & Раскрывает скобки в выражении S \\\\
			\lstinline!factor(S)! & Разлагает на множители выражение S\\\\
			\lstinline!simplify(S)! & Упрощает каждый элемент символьной матрицы S\\\\
			\lstinline!subs(S, oldvar, newvar)! & Заменяет в выражении S каждое вхождение \\
			    & символической переменной oldvar новой переменной newvar\\\\
		\end{tabular}

		Примеры использования можно увидеть ниже:
		\begin{itemize}
			\item {\bf Раскрытие скобок}
\begin{lstlisting}
>> syms s;
>> A = s + 2;
>> B = s + 3;
>> C = A*B
C = 
(s+2)*(s+3)
>> C = expand(C)
C = 
s^2 + 5*s + 6
\end{lstlisting}
			\item {\bf Разложение на множители}
\begin{lstlisting}
>> syms s;
>> D = s^2 + 6*s + 9;
>> D = factor(D)
D = 
(s+3)^2
>> p = s^3 - 2*s^2 - 3*s + 10;
>> P = factor(p)
P = 
(s+2)*(s^2 - 4*s + 5)
\end{lstlisting}
			\item {\bf Сокращение общего множителя}
\begin{lstlisting}
>> syms s;
>> H = (s^3 + 2*s^2 + 5*s + 10)/(s^2 + 5);
>> H = simplify(H)
H = 
s+2
>> factor(s^3 + 2*s^2 + 5*s + 10)
ans = 
(s+2)*(s^2 + 5)
\end{lstlisting}
			\item {\bf Подстановка переменной} \\
				Путь имеется выражение $H(s) = \dfrac{s + 3}{s^2 + 6s + 8}$ и 
				требуется вычислить $G(s) = H(s) |_{s=s+2}$.

\begin{lstlisting}
>> syms s;
>> H = (s + 3)/(s^2 + 6*s + 8);
>> G = subs(H, s, s+2)
G = 
(s+5)/((s+2)^2 + 6*s + 20)
>> G = collect(G)
G = 
(s+5)/(s^2 + 10*s + 24)
\end{lstlisting}
				Таким образом, $G(s) = \dfrac{s+5}{s^2+10s+24}$.
		\end{itemize}
		Отметим, что конечный результат символьных преобразований далеко не всегда
		выглядит так, как хотелось бы пользователю и бывает неудобно работать с ним
		дальше.

\subsection{Вычисление символьных выражений и отрисовка}
	Рано или поздно наступает момент, когда нам необходимо вычислить
	числовое значение результата выкладок или нарисовать график функции,
	выраженной символьным объектом. Рассмотрим, какие возможности для этого
	предоставляет нам MATLAB. 
	\subsubsection{Вычисления значения выражения}
		\begin{tabular}{ll}
			\lstinline!double(S)! & Преобразует символьную матрицу S,
				заменяя ее  элементы их численными\\ 
				& значениями. Матрица S не должна содержать символьных переменных\\\\
		\end{tabular}

		Как следует из описания функции, в символическом выражении перед вычислением
		его численного значения необходимо сделать все возможные подстановки, чтобы избавиться
		от свободных символьных переменных. Рассмотрим пример:
\begin{lstlisting}
>> syms s;
>> E = s^3 -14*s^2 + 65*s - 100);
>> F = subs(E, s, 7.1)
F = 
13671/1000
>> G = double(F)
G = 
13.6710
\end{lstlisting}
	\subsubsection{Рисование при помощи функции {\it ezplot}}

		Символическое выражение может быть нарисовано непосредственно при помощи функции
		{\it ezplot}:\\\\
		\begin{tabular}{ll}
			\lstinline!ezplot(f)! & Рисует график функции $f(x)$, где $f$
				является математической\\
				& функцией переменной $x$. Интервал, на котором изображается \\
				& график, по умолчанию равен $[-2\pi, 2\pi]$. \\\\
				\lstinline!ezplot(f,xmin,xmax)! & Рисует график на заданном интервале. \\
		\end{tabular}
		Например, график кубического многочлена
		\[
			A(s) = s^3 + 4s^2 - 7s - 10
		\]
		на интервале $[-1, 3]$ можно нарисовать следующим образом:
\begin{lstlisting}
>> syms s;
>> A = s^3 + 4*s^2 - 7*s - 10;
>> ezplot(A, -1, 3), ylabel('A(s)')
\end{lstlisting}
		В результате мы получим график наподобие того, что приведен ниже. Отметим,
		что название оси абсцисс и всего графика определяется автоматически.
		Они могут быть изменены обычным способом (см. команды {\it xlabel, title}).


	\subsubsection{Рисование при помощи функции {\it plot}}
		




\subsection{Решение уравнений и систем уравнений}
	\subsubsection{Элементы линейной алгебры}
	\subsubsection{Решение уравнений при помощи функции {\it solve}}
	\subsubsection{Численное решение уравнений, заданных символьным выражением}
\subsection{Элементы математического анализа}
	\subsubsection{Дифференицрование}
	\subsubsection{Интегрирование}
\subsection{Решение дифференциальных уравнений}
	\subsubsection{Решение ОДУ при помощи функции {\it dsolve}}
	\subsubsection{Численное решение уравнений, заданных символьным выражением}
\subsection{Дополнительная литература}
\end{document}















