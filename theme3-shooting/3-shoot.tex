\documentclass[12pt,a4paper]{article}
\usepackage[warn] {mathtext}
\usepackage[cp1251]{inputenc}
\usepackage[english, russian]{babel}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{pgfplots}
\usepackage{wrapfig}
\usepackage[top=2cm, bottom=2cm, marginparwidth=0pt, left=3cm, right=1.5cm]{geometry}
\usepackage[ruled]{algorithm2e}

\renewcommand\qedsymbol{$\blacksquare$}
\renewcommand{\labelenumi}{\arabic{enumi}) }

\begin{document}

\newtheorem*{Def}{Определение}
\newtheorem*{Th}{Теорема}
\newtheorem*{Lem}{Лемма}
\newtheorem*{Note}{Замечание}
\newtheorem*{Ex}{Пример}

\newenvironment{Sol}{\textbf{Решение.\linebreak}}

\setcounter{section}{1}
\section{Метод стрельбы}

	Метод стрельбы (иногда также называемый баллистическим методом или
	методом начальных параметров) не решает краевую задачу для уравнения
	Эйлера в исходной постановке, а сводит ее к последовательности более
	простых задач, а именно --- задач Коши с особым образом
	сформулированными начальными условиями.

	Как и ранее, мы рассмотрим вначале случай линейного уравнения Эйлера,
	поскольку для него метод стрельбы принимает особо простой вид. Позже
	перейдем к более общему случаю. Одна сперва сформулируем условие
	существования и единственности решения краевой задачи.

	\begin{Th}

	Рассмотрим краевую задачу
	\[
		y'' = f(x, y, y'), \qquad x \in [a, b], \quad y(a) = \alpha, y(b) = \beta .
	\]
	Если выполнены следующие условия:
	\begin{enumerate}
		\item функции $f, f_y, f_{y'}$ непрерывны в области 
			$D = \left\{(x,y,y') | x \in [a,b], y \in \mathbb{R}, y' \in \mathbb{R} \right\}$;
		\item $f_{y'} \geq \delta > 0$ на $D$;
		\item $\exists M: M = \max\limits_D|f_{y'}(x,y,y')|$;
	\end{enumerate}
	то краевая задача имеет единственное решение.
	\end{Th}

	Заметим, что в данных указаниях мы не рассматриваем в деталях численные
	методы решения задачи Коши. Предполагается, что этот материал уже
	известен из курса численных методов, однако для справки в Приложении B
	приводится описание метода Эйлера 1-го порядка точности.

\subsection{Метод стрельбы в случае линейного уравнения Эйлера}

	Пусть применение необходимого условия экстремума приводит к линейной
	краевой задаче, которую мы запишем в виде
	\[
		\begin{cases}
			&y''(x) = p(x)y'(x) + q(x)y(x) + r(x), \quad x \in \left[a, b\right], \\
			& y(a) = \alpha, \quad y(b) = \beta .
		\end{cases}
	\]
	Если предположить, что $p(x), q(x), r(x)$ непрерывны на отрезке $[a, b]$ и, 
	кроме того, $q(x) > 0$, то эта задача имеет единственное решение в силу
	сформулированной выше теоремы.
	
	Рассмотрим теперь две задачи Коши (т.е. задачи с начальными условиями):
	\begin{equation}
		\begin{cases}
			&y''(x) = p(x)y'(x) + q(x)y(x) + r(x), \quad x \in \left[a, b\right], \\
			& y(a) = \alpha, \quad y'(a) = 0,
		\end{cases}
	\end{equation}
	и
	\begin{equation}
		\begin{cases}
			&y''(x) = p(x)y'(x) + q(x)y(x), \quad x \in \left[a, b\right], \\
			& y(a) = 0, \quad y'(a) = 1.
		\end{cases}
	\end{equation}

	В силу наложенных ограничений на правую часть уравнений, обе задачи 
	имеют единственное решение. Обозначим через $y_1(x)$ решение задачи (1), а
	через $y_2(x)$ --- задачи (2). Предполагая, что $y_2(b) \neq 0$, определим
	функцию
	\[
		y(x) = y_1(x) + \frac{\beta - y_1(b)}{y_2(b)}y_2(x) .
	\]
	Заметим, что $y_2(b) = 0$ противоречит условиям, сформулированным выше.

	Легко показать, что $y(x)$ является решением исходной краевой задачи.
	Действительно, найдем производные функции $y(x)$:
	\begin{align*}
		&y'(x) = y'_1(x) + \frac{\beta - y_1(b)}{y_2(b)}y'_2(x), \\
		&y''(x) = y''_1(x) + \frac{\beta - y_1(b)}{y_2(b)}y''_2(x) \\
	\end{align*}
	и подставим эти выражения в уравнение Эйлера:
	\[
		\begin{array}{lcl}
			y''(x) &=& \left[p(x)y'_1(x) + q(x)y_1(x) + r(x)\right] + 
				\dfrac{\beta - y_1(b)}{y_2(b)}\left[p(x)y'_2(x) + q(x)y_2(x)\right] = \\ \\
			&=& p(x)\left[y'_1(x) + \dfrac{\beta - y_1(b)}{y_2(b)}y'_2(x)\right] + 
			q(x)\left[y_1(x) + \dfrac{\beta - y_1(b)}{y_2(b)}y_2(x)\right] + r(x) = \\ \\
			&=& p(x)y'(x) + q(x)y(x) + r(x) .
		\end{array}
	\]


	Кроме того, 
	\[
		y(a) = y_1(a) + \frac{\beta - y_1(b)}{y_2(b)}y_2(a) = 
			\alpha + \frac{\beta-y_1(b)}{y_2(b)}\cdot 0 = \alpha ,
	\]
	и
	\[
		y(b) = y_1(b) + \frac{\beta - y_1(b)}{y_2(b)}y_2(b) = \beta .
	\]

	Таким образом, решение краевой задачи (а значит, и вариационной задачи)
	свелось к решению двух задач Коши. Дадим небольшую графическую иллюстрацию
	метода:

	\begin{center}
	\begin{tikzpicture}
		\begin{axis}[
			%axis equal image=true,	
			%scale=2,
			y=2cm,
			axis equal=false,
			axis x line=middle,
			axis y line=left,
			xlabel=$x$,ylabel=$y$,
			xmin=0, xmax=1.25,
			ymin=-1, ymax=2.25,
			xtick={0.05, 0.95},
			ytick={0, 2},
			xticklabels={$a$, $b$},
			yticklabels={$\alpha$, $\beta$}
			]
			\addplot[blue, ultra thick, domain=0:1] 	{-0.25*(exp(2*x) - exp(-2*x)) + x};
			\addplot[blue, ultra thick, domain=0:1] 	{0.25*(exp(2*x) - exp(-2*x))};
			\addplot[black, ultra thick, domain=0:1] 	{(exp(2*x)-exp(-2*x))/(exp(2)-exp(-2))+x};
			\addplot[black, dashed, mark=''] plot coordinates { (1, -1) (1, 2.25) };
			\addplot[black, dashed, mark=''] plot coordinates { (0, 2) (1.25 ,2) };
			\addplot[black, dashed, mark=''] plot coordinates { (0, 0) (1.25, 1.25)};

			\node at (3cm, 1cm) {$y=y_1(x)$};
			\node at (5.8cm, 4.5cm  ) {$y=y_2(x)$};
			\node at (3.5cm, 5cm  ) {$y=y(x)$};
			\node at (2.8cm, 2.4cm  ) {$\tg(\alpha)=1$};
			
		\end{axis}
	\end{tikzpicture}
	\end{center}
	Заметим, что точность метода в линейном случае определяется точностью решение задач Коши.

	Ниже приведен пример, который можно использовать при отладке.
	\begin{Ex}
		Решим краевую задачу для уравнения Эйлера
		\[
		\begin{cases}
			& y'' = 4(y-x), \quad x \in [0,1] \\
			& y(0) = 0, \quad y(1) = 2
		\end{cases}
		\]
	\end{Ex}
	\begin{Sol}
		Заметим, что в этом уравнении $p(x) = 0$, $q(x) = 4 > 0$, $r(x) = -4x$. 
		Таким образом, условия теоремы выполняются и задача имеет решение и притом
		единственное.

		Рассмотрим, согласно изложенной схеме метода, две задачи Коши:

		\[
		\begin{cases}
			&y_1'' = 4y_1 - 4x, \quad x \in \left[0, 1\right], \\
			& y_1(0) = 0, \quad y_1'(0) = 0,
		\end{cases}
		\]
		и
		\[
		\begin{cases}
			&y_2''(x) = 4y_2, \quad x \in \left[0, 1\right], \\
			& y_2(0) = 0, \quad y_2'(0) = 1.
		\end{cases}
		\]
		
		Нетрудно найти решение этих задач:
		\[
			y_1(x) =-\frac{1}{4}\left(e^{2x} - e^{-2x}\right) + x ,	\qquad 
			y_2(x) = \frac{1}{4}\left(e^{2x} - e^{-2x}\right).
		\]
		Осталось составить решение краевой задачи:
		\[
			y(x) = y_1(x) + \frac{2 - y_1(1)}{y_2(1)}y_2(x) = 
			\frac{e^{2x}-e^{-2x}}{e^2 - e^{-2}} + x .
		\]
	\end{Sol}

	
\subsection{Метод стрельбы для уравнения Эйлера общего вида}
	
	Попробуем применить изложенную идею к краевой задаче более общего вида:
	\[
		\begin{cases}
			&y'' = f(x, y, y'), \quad x \in \left[a, b\right], \\
			& y(a) = \alpha, \quad y(b) = \beta .
		\end{cases}
	\]
	Задавшись некоторым произвольным значением $t_0$, рассмотрим задачу Коши вида
	\[
		\begin{cases}
			&y'' = f(x, y, y'), \quad x \in \left[a, b\right], \\
			& y(a) = \alpha, \quad y'(a) = t_0 .
		\end{cases}
	\]
	Пусть $y(x; t_0)$ --- ее решение. Очевидно, что, вообще говоря, $y(b; t_0) \neq \beta$.
	На рисунке ниже приведена геометрическая интерпретация того, что произошло: выбрав угол
	наклона <<пушки>> равным $t_0$, мы попали не в цель --- точку $(b, \beta)$, --- а
	в точку $(b, y(b; t_0))$.
	\begin{wrapfigure}{r}{9cm}
	\begin{tikzpicture}
		\begin{axis}[
			%axis equal image=true,	
			%scale=10,
			%y=2cm,
			height=8cm,
			width=8cm,
			axis equal=false,
			axis x line=middle,
			axis y line=left,
			xlabel=$x$,ylabel=$y$,
			xmin=-0.5, xmax=4,
			%ymin=0, ymax=6,
			xtick={0.0, 2.5},
			ytick={1, 6.842},
			xticklabels={$a$, $b$},
			yticklabels={$\alpha$, $\beta$}
			]
			\addplot[blue, ultra thick, domain=0:2.5] 	{exp(x/1.5)};
			\addplot[black, ultra thick, domain=0:2.5] 	{exp(x/1.3)};
			\addplot[blue, ultra thick, domain=0:2.5] 	{exp(x/1.2)};
			\addplot[blue, ultra thick, domain=0:2.5] 	{exp(x/1.6)};
			\addplot[blue, ultra thick, domain=0:2.5] 	{exp(x/1)};
			\addplot[black, dashed, mark=''] plot coordinates { (0, 0) (0, 1) };
			\addplot[black, dashed, mark=''] plot coordinates { (-0.5, 1) (3, 1) };
			\addplot[black, dashed, mark=''] plot coordinates { (2.5, 0) (2.5, 14) };
			\addplot[black, dashed, mark=''] plot coordinates { (-0.5, 6.842) (2.5, 6.842) };
			\addplot[red, dashed, mark=''] plot coordinates { (0, 1) (3, 3)};

			\node at (5.3cm, 3.1cm) {$y(x)$};
			\node at (5.3cm, 2cm) {$y(x; t_0)$};
			\node at (5.3cm, 5.3cm) {$y(x; t_1)$};
			\node at (5.3cm, 2.4cm) {$y(x; t_2)$};
			\node at (5.3cm, 3.7cm) {$y(x; t_3)$};
			\node at (3cm, 0.7cm) {$\alpha$};
			\node at (2cm, 4cm) {$t = \tg\alpha$};

		\end{axis}
	\end{tikzpicture}
	\end{wrapfigure}
	Фактически, метод стрельбы сводит краевую задачу (а значит, и вариационную 
	задачу тоже) к решению трансцендентного уравнения 
	\[
		y(x; t) = \beta
	\]
	относительно параметра $t$, имеющего смысл угла наклона касательной к графику решения в
	начальной точке.

	Вообще говоря, для решения этого уравнения пригоден любой удобный метод.
	Мы рассмотрим подробно применение метода Ньютона. Напомним, что в этом
	методе строится последовательность
	\[
		x^{k+1} = x^k - J^{-1}\left(x^k\right)f\left(x^k\right) ,
	\]
	которая при определенных условиях сходится к решению уравнения (системы уравнений)
	$f(x)=0$. Здесь $J(x) = \left(\dfrac{\partial f_i}{\partial x_j}\right)$ --- 
	якобиан системы уравнений. В нашем случае формула итераций принимает, очевидно,
	следующий вид
	\[
		t_{k+1} = t_k - \frac{y(b; t_k) - \beta}{\dfrac{d}{dt}y(b; t_k)}.
	\]
	Основную проблему составляет вычисление производной $\dfrac{d}{dt}y(b; t)$.
	Оказывается, что для этого достаточно решить одну задачу Коши. Действительно, 
	рассмотрим подробнее задачу
	\[\label{cauchy1}
		\begin{cases}
			&y''(x; t) = f(x, y(x; t), y'(x; t)), \quad x \in [a, b] \\
			&y(a; t) = \alpha, \quad y'(a; t) = t
		\end{cases}\tag{*}
	\]
	Продифференцируем уравнение по $t$ (аргументы $y$ в правой части опускаем для простоты):
	\[
		\frac{\partial}{\partial t}y''(x; t) = 
		\frac{\partial f(x, y, y')}{\partial x}\cdot\frac{\partial x}{\partial t} + 
		\frac{\partial f(x, y, y')}{\partial y}\cdot\frac{\partial y}{\partial t} + 
		\frac{\partial f(x, y, y')}{\partial y'}\cdot\frac{\partial y'}{\partial t}.
	\]
	Так как $t$ никак не связано с $x$, то первое слагаемое обращается в нуль. Дифференцирование
	же начальных условий дает 
	\[
		\frac{\partial y(a; t)}{\partial t}=0, \qquad 
		\frac{\partial y'(a; t)}{\partial t} = 1.
	\]
	Чтобы упростить обозначения, введем функцию $z(x;t) = \dfrac{\partial y(x; t)}{\partial t}$.
	Предположим, что порядок дифференцирования по $t$ и $x$ можно поменять местами.
	Получаем задачу Коши
	\[\label{cauchy2}
		\begin{cases}
			&z''(x; t) = 
			\dfrac{\partial f(x, y, y')}{\partial y}\cdot z(x; t) + 
			\dfrac{\partial f(x, y, y')}{\partial y'}\cdot z'(x;t), \quad x \in [a, b] \\
			&z(a; t) = 0, \quad z'(a; t) = 1,
		\end{cases}\tag{**}
	\]
	в которой параметр $t$ уже не фигурирует явно.

	Итак, последовательность приближений ${t_k}$ в методе Ньютона строится по формуле:
	\[
		t_{k+1} = t_k - \frac{y(b; t_k) - \beta}{z(x; t_k)},
	\]
	где $z(x; t_k)$ --- решение задачи Коши (\refeq{cauchy2}), а $y(x; t_k)$ ---
	задачи (\refeq{cauchy1}) при $t = t_k$. Таким образом, на каждой итерации необходимо
	решить две задачи Коши.







\end{document}















