\documentclass[12pt,a4paper]{article}
\usepackage[warn] {mathtext}
\usepackage[cp1251]{inputenc}
\usepackage[english, russian]{babel}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[top=2cm, bottom=2cm, marginparwidth=0pt, left=3cm, right=1.5cm]{geometry}
\usepackage{mathtools}
\usepackage{pgfplots}
\usepackage[ruled]{algorithm2e}

\renewcommand{\labelenumii}{\arabic{enumi}.\arabic{enumii}.}

\begin{document}
\section*{Приложение A. Численное интегрирование}
Основная идея большинства способов вычисления определенных интегралов заключается
в замене подынтегральной функции другой, близкой к ней по значениям, но позволяющей
вычислить интеграл проще. Для этой цели, как правило, используются многочлены. Например,
формула Симпсона получается заменой подынтегральной функции квадратичной функцией, которая
принимает одинаковые с ней значения в трех точках промежутка интегрирования: в начале, 
конце и середине промежутка.

\begin{center}
\begin{tikzpicture}
	\pgfplotsset{every axis plot/.append style={line width=1.0pt}}
	\begin{axis}[
		width=6cm, scale only axis,
		xlabel=x,
		ylabel=y,
		xtick=\empty,
		ytick=\empty,
		xmin=0, xmax=1,
		ymin=0.1,
		extra x ticks={0.25, 0.5, 0.75},
		extra x tick labels={$x_0$, $x_1$, $x_2$},
		axis x line=left,
		axis y line=left]
		\addplot[fill, gray!20!white, ultra thick, domain=0.25:0.75]
			{(10*(x-0.1)^3-15*(x-0.1)^2+7.33125*(x-0.1))}
			\closedcycle;
		\addplot[blue, ultra thick, domain=0.25:0.75]
			{(10*(x-0.1)^3-15*(x-0.1)^2+7.33125*(x-0.1))};
		\addplot[black, domain=0.25:0.75] {-3*x^2+3.75625*x+0.044375};
	\draw (4cm,4.5cm) node {$y=f(x)$};
	\end{axis}
\end{tikzpicture}
\end{center}

Если обозначить $h=\dfrac{b-a}{2}$ и заменить подынтегральную функцию отрезком ее
разложения в ряд Тейлора, то можно получить следующую формулу:
\[
	\int\limits_a^b f(x) dx = \frac{h}{3}\left[f(x_0)+4f(x_1)+f(x_2)\right] - 
		\frac{h^5}{90}f^{(4)}(\xi)\,.
\]
Чтобы вычислить приближенное значение интеграла, достаточно отбросить последнее слагаемое в ней.
Очевидно, что на достаточно больших промежутках интегрирования погрешность может
стать слишком большой. Поэтому, как правило, промежуток разбивают на маленькие части и,
пользуясь аддитивностью интеграла, заменяют исходный интеграл суммой приближенных значений.

Пусть подынтегральная функция имеет непрерывные производные до четвертого порядка включительно.
Разобъем промежуток интегрирования $[a, b]$ на равные отрезки точками $x_j = a+hj, j=\overline{0,n}$,
где $h=\dfrac{b-a}{n}$. Можно показать, что существует такое $\xi \in (a,b)$, что
\[
	\int\limits_a^b f(x)dx = \frac{h}{3}\left[
		f(a) + 2\sum\limits_{j=1}^{\frac{n}{2}-1}f(x_{2j}) + 
			4\sum\limits_{j=1}^{\frac{n}{2}}f(x_{2j-1}) + f(b)
			\right] + \frac{b-a}{180}h^4f^{(4)}(\xi)\,.
\]
Отбросив последнее слагаемое, получим формулу приближенного значения интеграла, которая
называется составной формулой Симпсона. Ее просто запрограммировать и она имеет достаточно
высокую точность. Подробные сведения о методах численного интегрирования можно найти в \cite{bahvalov,kalitkin}.

Приведем псевдокод алгоритма метода Симпсона.

\begin{algorithm}[H]
	\DontPrintSemicolon
	\NoCaptionOfAlgo
	\SetKwInOut{Input}{ВХОД} 
	\SetKwInOut{Output}{ВЫХОД}
	\SetKwInOut{KwPrint}{ВЫВЕСТИ}
	\BlankLine
	\Input{Концы промежутка интегрирования $a$ и $b$, натуральное число $n$.}
	\BlankLine
	\Output{$I$ --- приближенное значение интеграла.}
	\BlankLine
	\nlset{ШАГ 1} Полагаем $h = \dfrac{b-a}{n}$ \;

	\nlset{ШАГ 2} Полагаем \\
			$I_0 = f(a)+f(b)$ \\
			$I_1 = 0$ \\
			$I_2 = 0$ \;
	
	\nlset{ШАГ 3} \For{$i \leftarrow 1$ \KwTo $n-1$}{
			\Indp {
				$x = a + ih$  \;
				\eIf{$i$ --- нечетное}{
					$I_2 \leftarrow I_2 + f(x)$
				}{
					$I_1 \leftarrow I_1 + f(x)$
				}\;
			}
			\Indm}

	\nlset{ШАГ 4}	$I = \dfrac{h}{3}\left(I_0 + 4I_1 + 2I_2\right)$ \;
	\BlankLine
	\nlset{ШАГ 5} 	\KwPrint{$I$}
	\BlankLine
	\nlset{ШАГ 6} Процедура окончена.				

	\caption{\Large Составная формула Симпсона}
\end{algorithm}
\vspace{5em}
\begin{thebibliography}{3}
	\bibitem{bahvalov} Бахвалов Н.\,С. Численные методы М.: Наука, 1975
	\bibitem{kalitkin} Калиткин Н.\,Н. Численные методы. М.: Наука, 1978
\end{thebibliography}
\end{document}
















